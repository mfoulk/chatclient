(function(e){function t(t){for(var r,c,o=t[0],s=t[1],u=t[2],l=0,v=[];l<o.length;l++)c=o[l],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&v.push(a[c][0]),a[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);d&&d(t);while(v.length)v.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var s=n[o];0!==a[s]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},i=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/chatclient/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var d=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},2:function(e,t){},"4f54":function(e,t,n){"use strict";n("d36f")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function a(e,t,n,a,i,c){var o=Object(r["j"])("Chat");return Object(r["f"])(),Object(r["c"])(o)}var i=Object(r["o"])("data-v-34964522");Object(r["h"])("data-v-34964522");var c={id:"chat"},o={key:0},s={key:1};Object(r["g"])();var u=i((function(e,t,n,a,i,u){var d=Object(r["j"])("Conversation");return Object(r["f"])(),Object(r["c"])("div",c,[Object(r["e"])("p",null,Object(r["k"])(i.statusString),1),i.nameRegistered?Object(r["d"])("",!0):(Object(r["f"])(),Object(r["c"])("div",o,[Object(r["m"])(Object(r["e"])("input",{onKeyup:t[1]||(t[1]=Object(r["n"])((function(){return u.registerName&&u.registerName.apply(u,arguments)}),["enter"])),"onUpdate:modelValue":t[2]||(t[2]=function(e){return i.linkkey=e}),placeholder:"Enter your link key: XXX-XXX-XXX"},null,544),[[r["l"],i.linkkey]]),Object(r["e"])("button",{onClick:t[3]||(t[3]=function(){return u.registerName&&u.registerName.apply(u,arguments)})},"Next")])),i.nameRegistered&&!i.activeConversation&&i.isConnected?(Object(r["f"])(),Object(r["c"])("div",s,[Object(r["e"])("button",{onClick:t[4]||(t[4]=function(){return u.createConversation&&u.createConversation.apply(u,arguments)})},"Join chat")])):Object(r["d"])("",!0),i.activeConversation?(Object(r["f"])(),Object(r["c"])(d,{key:2,"active-conversation":i.activeConversation,name:i.identity},null,8,["active-conversation","name"])):Object(r["d"])("",!0)])})),d=n("1da1"),l=(n("d3b7"),n("a15b"),n("96cf"),n("9969")),v=(n("b0c0"),Object(r["o"])("data-v-6fbdd291"));Object(r["h"])("data-v-6fbdd291");var f={id:"conversation"},b={class:"conversation-container"},p={class:"bubble"},h={class:"name"},g={class:"message"},m={class:"input-container"};Object(r["g"])();var j=v((function(e,t,n,a,i,c){return Object(r["f"])(),Object(r["c"])("div",f,[Object(r["e"])("div",b,[(Object(r["f"])(!0),Object(r["c"])(r["a"],null,Object(r["i"])(i.messages,(function(e){var t,a,i;return Object(r["f"])(),Object(r["c"])("div",{key:e.index,class:["bubble-container",{myMessage:(null===e||void 0===e||null===(t=e.state)||void 0===t?void 0:t.author)===n.name}]},[Object(r["e"])("div",p,[Object(r["e"])("div",h,Object(r["k"])(null===e||void 0===e||null===(a=e.state)||void 0===a?void 0:a.author)+":",1),Object(r["e"])("div",g,Object(r["k"])(null===e||void 0===e||null===(i=e.state)||void 0===i?void 0:i.body),1)])],2)})),128))]),Object(r["e"])("div",m,[Object(r["m"])(Object(r["e"])("input",{onKeyup:t[1]||(t[1]=Object(r["n"])((function(){return c.sendMessage&&c.sendMessage.apply(c,arguments)}),["enter"])),"onUpdate:modelValue":t[2]||(t[2]=function(e){return i.messageText=e}),placeholder:"Enter your message"},null,544),[[r["l"],i.messageText]]),Object(r["e"])("button",{onClick:t[3]||(t[3]=function(){return c.sendMessage&&c.sendMessage.apply(c,arguments)})},"Send message")])])})),O=n("2909"),y=(n("99af"),{props:["activeConversation","name"],data:function(){return{messages:[],messageText:"",isSignedInUser:!1}},mounted:function(){var e=this;this.activeConversation.getMessages().then((function(t){e.messages=[].concat(Object(O["a"])(e.messages),Object(O["a"])(t.items))})),this.activeConversation.on("messageAdded",(function(t){e.messages=[].concat(Object(O["a"])(e.messages),[t])}))},methods:{sendMessage:function(){var e=this;this.activeConversation.sendMessage(this.messageText).then((function(){e.messageText=""}))}}});n("4f54");y.render=j,y.__scopeId="data-v-6fbdd291";var k=y,C={components:{Conversation:k},data:function(){return{statusString:"",activeConversation:null,token:null,linkkey:"450-392-672",identity:null,nameRegistered:!1,isConnected:!1}},methods:{initConversationsClient:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return window.conversationsClient=l["Client"],e.next=3,this.getToken(this.linkkey);case 3:return t=e.sent,e.next=6,l["Client"].create(t);case 6:this.conversationsClient=e.sent,this.statusString="Connecting to Twilio…",this.conversationsClient.on("connectionStateChanged",(function(e){switch(e){case"connected":n.statusString="You are connected.",n.isConnected=!0;break;case"disconnecting":n.statusString="Disconnecting from Twilio…";break;case"disconnected":n.statusString="Disconnected.";break;case"denied":n.statusString="Failed to connect.";break}}));case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getToken:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://apidev.loanscience.com/conversation/token/".concat(t),{method:"POST"});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,this.identity=r.identity,this.token=r.token,e.abrupt("return",this.token);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),registerName:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.nameRegistered=!0,e.next=3,this.initConversationsClient();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getChatName:function(){return"test:chat:".concat(this.linkkey)},createConversation:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.conversationsClient.createConversation({uniqueName:this.getChatName()});case 3:return t=e.sent,e.next=6,t.join().catch((function(e){return console.log(e)}));case 6:return n=e.sent,e.next=9,n.add(this.identity).catch((function(e){return console.log("error: ",e)}));case 9:this.activeConversation=n,e.next=17;break;case 12:return e.prev=12,e.t0=e["catch"](0),e.next=16,this.conversationsClient.getConversationByUniqueName(this.getChatName());case 16:this.activeConversation=e.sent;case 17:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(){return e.apply(this,arguments)}return t}()}};n("7ee7");C.render=u,C.__scopeId="data-v-34964522";var w=C,x={name:"App",components:{Chat:w}};n("64e9");x.render=a;var S=x;Object(r["b"])(S).mount("#app")},"64e9":function(e,t,n){"use strict";n("ba66")},"7ee7":function(e,t,n){"use strict";n("f783")},ba66:function(e,t,n){},d36f:function(e,t,n){},f783:function(e,t,n){}});
//# sourceMappingURL=app.56efcf5d.js.map